<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>PIVOT Scoring Configuration</title><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet"><style>body{background:#f6f8fb;font-family:Inter,system-ui,Arial}.card{border-radius:12px;padding:20px}.small-muted{color:#6b7280}</style></head><body>
<div class="container py-4"><div class="card p-4"><div class="d-flex justify-content-between align-items-center mb-3"><h4>Scoring configuration</h4><a href="policy-ui-toggle.html" class="btn btn-outline-primary">Back to UI</a></div>
<p class="small-muted">Adjust component weights (they sum to 100). Change thresholds for Accept/Review.</p>
<form id="cfgForm" class="row g-3">
<div class="col-md-6"><label class="form-label">Required fields weight</label><input name="required_fields" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">Dates & term weight</label><input name="dates_term" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">Sum insured weight</label><input name="sum_insured" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">Insured consistency weight</label><input name="insured_consistency" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">Contact & IDs weight</label><input name="contact_ids" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">Nominee weight</label><input name="nominee" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">PED weight</label><input name="ped" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">Seller/Office weight</label><input name="seller_office" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">Accept threshold</label><input name="accept" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-md-6"><label class="form-label">Review threshold</label><input name="review" class="form-control" type="number" step="1" min="0" max="100"></div>
<div class="col-12"><div class="d-flex gap-2"><button id="saveBtn" class="btn btn-primary">Save configuration</button><button id="resetBtn" class="btn btn-outline-secondary">Reset defaults</button><button id="exportBtn" class="btn btn-outline-info">Export JSON</button><input id="importFile" type="file" class="form-control-file" style="display:none"></div></div>
<div class="col-12"><div id="msg"></div></div>
</form>
<script>
const DEFAULT_CONFIG = {
  weights:{ required_fields:30, dates_term:15, sum_insured:15, insured_consistency:15, contact_ids:10, nominee:5, ped:5, seller_office:5 },
  thresholds: { accept:85, review:65 }
};
function loadConfig(){ try{ const raw = localStorage.getItem('pivot_scoring_config'); if(raw) return JSON.parse(raw); }catch(e){} return DEFAULT_CONFIG; }
function populate(){ const cfg=loadConfig(); const w=cfg.weights; document.querySelector('[name=required_fields]').value = w.required_fields; document.querySelector('[name=dates_term]').value = w.dates_term; document.querySelector('[name=sum_insured]').value = w.sum_insured; document.querySelector('[name=insured_consistency]').value = w.insured_consistency; document.querySelector('[name=contact_ids]').value = w.contact_ids; document.querySelector('[name=nominee]').value = w.nominee; document.querySelector('[name=ped]').value = w.ped; document.querySelector('[name=seller_office]').value = w.seller_office; document.querySelector('[name=accept]').value = cfg.thresholds.accept; document.querySelector('[name=review]').value = cfg.thresholds.review; }
function saveConfigObj(cfg){ try{ localStorage.setItem('pivot_scoring_config', JSON.stringify(cfg)); return true;}catch(e){return false;} }
document.getElementById('saveBtn').addEventListener('click', function(ev){ ev.preventDefault(); const cfg={weights:{ required_fields: Number(document.querySelector('[name=required_fields]').value||0), dates_term: Number(document.querySelector('[name=dates_term]').value||0), sum_insured: Number(document.querySelector('[name=sum_insured]').value||0), insured_consistency: Number(document.querySelector('[name=insured_consistency]').value||0), contact_ids: Number(document.querySelector('[name=contact_ids]').value||0), nominee: Number(document.querySelector('[name=nominee]').value||0), ped: Number(document.querySelector('[name=ped]').value||0), seller_office: Number(document.querySelector('[name=seller_office]').value||0) }, thresholds: { accept: Number(document.querySelector('[name=accept]').value||0), review: Number(document.querySelector('[name=review]').value||0) } }; const total = Object.values(cfg.weights).reduce((s,v)=>s+v,0); if(total !== 100){ document.getElementById('msg').innerHTML = '<div class="alert alert-warning">Weights sum to ' + total + '. They should sum to 100. Adjust before saving.</div>'; return; } saveConfigObj(cfg); document.getElementById('msg').innerHTML = '<div class="alert alert-success">Configuration saved.</div>'; });
document.getElementById('resetBtn').addEventListener('click', function(ev){ ev.preventDefault(); saveConfigObj(DEFAULT_CONFIG); populate(); document.getElementById('msg').innerHTML = '<div class="alert alert-info'>Reset to defaults.</div>'; });
document.getElementById('exportBtn').addEventListener('click', function(ev){ ev.preventDefault(); const cfg = loadConfig(); const blob = new Blob([JSON.stringify(cfg,null,2)],{type:'application/json'}); const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'pivot_scoring_config.json'; a.click(); URL.revokeObjectURL(url); });
const importFile = document.getElementById('importFile'); document.getElementById('exportBtn').insertAdjacentElement('afterend', importFile);
importFile.addEventListener('change', function(ev){ const f=importFile.files[0]; if(!f) return; const r=new FileReader(); r.onload = function(e){ try{ const cfg = JSON.parse(e.target.result); if(cfg.weights && cfg.thresholds){ saveConfigObj(cfg); populate(); document.getElementById('msg').innerHTML = '<div class="alert alert-success'>Configuration imported and saved.</div>'; } else document.getElementById('msg').innerHTML = '<div class="alert alert-danger'>Invalid config format</div>'; }catch(err){ document.getElementById('msg').innerHTML = '<div class="alert alert-danger'>Error parsing file</div>'; } }; r.readAsText(f); });
document.addEventListener('keydown', function(e){ if(e.altKey && e.key==='i'){ importFile.click(); } });
populate();
</script>
</div></div></body></html>